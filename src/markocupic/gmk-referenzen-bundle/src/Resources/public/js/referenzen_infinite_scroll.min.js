!function(n){ReferenzenInfiniteScroll=function(e){var o=n.extend({ids:[],newsContainer:".gmk_ref",scrollContainer:n(window),loadAllOnDomready:!1,itemsPerRequest:10,anchorPoint:"",bottomPixels:0,fadeInTime:800,msgText:"<em>Loading...</em>",onInitialize:function(n){},onXHRStart:function(n){},onXHRComplete:function(n,e){return n},onXHRFail:function(n){},onAppendCallback:function(n){}},e||{}),t=this,i=null,l=null,r=null,a=0,s=[],c=0,d=0;t.blnHasError=!1,t.currentUrl="",t.urlIndex=0,this.getOption=function(n){return void 0!==o[n]&&o[n]};var f=function(){1!=a&&1!=c&&(t.blnHasError=!1,s.length==t.urlIndex&&(c=1,void 0!==d&&clearInterval(d)),t.currentUrl=s[t.urlIndex],void 0!==t.currentUrl?n.ajax({url:t.currentUrl,beforeSend:function(){o.onXHRStart(t),a=1,""!=o.msgText&&n(o.msgText).addClass("infiniteScrollMsgText").appendTo(i).fadeIn(100)}}).done(function(n){t.blnHasError=!1;var e=n.split("***####***####***"),i={status:e[0],ids:e[1],html:e[2]};t.response=i;var l=o.onXHRComplete(i.html,t);!1===t.blnHasError?(t.urlIndex++,setTimeout(function(){m(l)},100)):u()}).fail(function(){u()}).always(function(){setTimeout(function(){n(".infiniteScrollMsgText").remove(),a=0},100)}):(c=1,void 0!==d&&clearInterval(d)))},u=function(){a=0,o.onXHRFail(t)},m=function(e){n(e).hide().appendTo(i).fadeIn(o.fadeInTime),o.onAppendCallback(t)};!function(){if(o.onInitialize(t),o.ids.length<1)console.log("ReferenzenInfiniteScroll aborted! There are no items to load.");else{var e=0,a=0,c=[];n.each(o.ids,function(n,t){e++,a++,c.push(t),e!=o.itemsPerRequest&&o.ids.length!=a||(s.push(window.location.href+"?ids="+c.join("-")),e=0,c=[])}),void 0!==(i=n(o.newsContainer)[0])?void 0!==(r=n(o.scrollContainer)[0])?(0==o.bottomPixels&&(o.bottomPixels=1),l=n(i),void 0!==n(o.anchorPoint)[0]&&(l=n(o.anchorPoint)[0]),!0===o.loadAllOnDomready?(f(),d=setInterval(f,100)):n(r).on("scroll",function(){n(r).scrollTop()>n(l).offset().top+n(l).innerHeight()-n(r).height()-o.bottomPixels&&f()})):console.log("ReferenzenInfiniteScroll aborted! Please select a valid scroll container."):console.log("ReferenzenInfiniteScroll aborted! Define a valid newsContainer in the template settings.")}}()}}(jQuery);